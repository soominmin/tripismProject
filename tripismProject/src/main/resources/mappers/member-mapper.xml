<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >

<mapper namespace="memberMapper">
	<resultMap type="Member" id="memberResultSet">
		<result column="MEM_NO" property="memNo"/>
		<result column="MEM_ID" property="memId"/>
		<result column="MEM_PWD" property="memPwd"/>
		<result column="MEM_NAME" property="memName"/>
		<result column="MEM_NICKNAME" property="memNickname"/>
		<result column="GENDER" property="gender"/>
		<result column="ENROLL_DATE" property="enrollDate"/>
		<result column="MEM_STATUS" property="status"/>
		<result column="MEM_MBTI" property="mbti"/>
		<result column="MEM_EMAIL" property="email"/>
		<result column="MEM_IMG" property="img"/>
	</resultMap>
	
	<resultMap type="Folder" id="folderResultSet">
		<result column="FOLDER_NO" property="folderNo"/>
		<result column="MEM_NO" property="memNo"/>
		<result column="FOLDER_NAME" property="folderName"/>
	</resultMap>


	<select id="loginMember" parameterType="Member" resultMap="memberResultSet">
		select
	        mem_no
	      , mem_id
	      , mem_pwd
	      , mem_name
	      , mem_nickname
	      , gender
	      , to_char(enroll_date, 'YYYY-MM-DD') as "enroll_date"
	      , mem_status
	      , mem_mbti
	      , mem_email
	      , mem_img
	  from tb_member
	 where mem_id = #{memId}
	   and mem_status = 'Y'
	</select>
	
	<insert id="insertMember">
		insert
			into tb_member
			(
			    mem_no
			  ,	mem_id
			  , mem_name
			  , mem_pwd
			  , mem_email
			  , mem_nickname
			  , gender
			)
			values
			(
			   seq_memno.nextval
			 , #{memId}
			 , #{memName}
			 , #{memPwd}
			 , #{email}
			 , #{memNickname}
			 , #{gender}
			)
	</insert>
	
	<select id="idCheck" resultType="_int">
			select
			   count(*)
		  from tb_member
		 where mem_id = #{checkId}
	</select>
	
	<select id="nicknameCheck" resultType="_int">
	         	select
			   count(*)
		  from tb_member
		 where mem_nickname = #{checkNickname}
	</select>
	
	<select id="emailCheck" resultType="_int">
				select
			   count(*)
		  from tb_member
		 where mem_email = #{email}
		 
	</select>
	
	<select id="idfind2" parameterType="Member" resultMap="memberResultSet">
		select
	        mem_no
	      , mem_id
	      , mem_name
	      , mem_email
	  from tb_member
	 where mem_name = #{memName}
	   and mem_email =#{email}
	   and mem_status = 'Y'
	</select>
	
	<select id="pwdfind" parameterType="Member" resultMap="memberResultSet">
		select
	        mem_no
	      , mem_id
	      , mem_pwd
	      , mem_name
	      , mem_nickname
	      , gender
	      , to_char(enroll_date, 'YYYY-MM-DD') as "enroll_date"
	      , mem_status
	      , mem_mbti
	      , mem_email
	      , mem_img
	  from tb_member
	 where mem_name = #{memName}
	   and mem_id = #{memId}
	   and mem_email = #{email}
	   and mem_status = 'Y'
	</select>
	
	<update id="pwdUpdate">
		update
			tb_member
		 set mem_pwd = #{memPwd}
		 where mem_id = #{memId}
		  and mem_email = #{email}
		  and mem_name = #{memName}
	</update>
	
	<update id="insertMBTI">
		update
			tb_member
		set mem_mbti = #{mbti}
		where mem_id = #{memId}
	</update>
	
	<update id="nicknameUpdate">
		update
			tb_member
	    set mem_nickname = #{memNickname}
	  where mem_id = #{memId}
	</update>
	
	<update id="deleteMember">
		update
			tb_member
		set mem_nickname = null
		  , mem_status = 'N'
		  , mem_email = null
		  where mem_id= #{memId}
	</update>
	
	<update id="profile">
		update
			tb_member
		set mem_img = #{img}
		where mem_no = #{memNo}
		  and mem_id= #{memId}
	</update>
	
	<insert id="insertFolder">
		insert
			into tb_member
			(
			    folder_no
			  ,	mem_no
			  , folder_name
			)
			values
			(
			   seq_folderno.nextval
			 , #{memNo}
			 , #{folderName}
			)
	</insert>
	
	

	


</mapper>